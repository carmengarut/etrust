(this.webpackJsonpclase4=this.webpackJsonpclase4||[]).push([[0],{65:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(33),a=n.n(c),o=n(10),s=n(2),i=n(0),u=function(e){var t=e.notes,n=Object(s.h)().id,r=t.find((function(e){return e.id===n}));return r?(console.log(r),Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:r.content}),Object(i.jsx)("div",{children:r.user.name}),Object(i.jsx)("div",{children:Object(i.jsx)("strong",{children:r.important?"important":""})})]})):null},l=n(8),j=n.n(l),b=n(11),d=n(3),O=n(14),h=n.n(O),f="/api/notes",p=null,g=function(e){p="Bearer ".concat(e)},v=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login/",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=n(12),m={CANCEL_BUTTON:"Cancel"},w=Object(r.forwardRef)((function(e,t){var n=e.children,c=e.buttonLabel,a=void 0===c?"show":c,o=Object(r.useState)(!1),s=Object(d.a)(o,2),u=s[0],l=s[1],j={display:u?"none":""},b={display:u?"":"none"},O=function(){return l(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:O}})),Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{style:j,children:Object(i.jsx)("button",{onClick:O,children:a})}),Object(i.jsxs)("div",{style:b,children:[n,Object(i.jsx)("button",{onClick:O,children:m.CANCEL_BUTTON})]})]})}));w.displayName="Toggable";var y=w,S=function(e){var t=e.type,n=Object(r.useState)(""),c=Object(d.a)(n,2),a=c[0],o=c[1];return{type:t,value:a,onChange:function(e){o(e.target.value)}}};function N(e){var t=S({type:"text"}),n=S({type:"password"});return Object(i.jsx)(y,{buttonLabel:"Show login",children:Object(i.jsxs)("form",{onSubmit:e.handleLogin,children:[Object(i.jsx)("div",{children:Object(i.jsx)("input",Object(x.a)(Object(x.a)({},t),{},{name:"Username",placeholder:"Username"}))}),Object(i.jsx)("div",{children:Object(i.jsx)("input",Object(x.a)(Object(x.a)({},n),{},{name:"Password",placeholder:"Password"}))}),Object(i.jsx)("button",{id:"form-login-button",children:"Login"})]})})}function k(){var e=Object(s.g)(),t=Object(r.useState)(null),n=Object(d.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)(""),u=Object(d.a)(o,2),l=u[0],O=u[1],h=Object(r.useState)(""),f=Object(d.a)(h,2),p=f[0],x=f[1],m=Object(r.useState)(null),w=Object(d.a)(m,2),y=w[0],S=w[1],k=function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,v({username:l,password:p});case 4:r=t.sent,window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(r)),g(r.token),S(r),O(""),x(""),e.push("/notes"),t.next=19;break;case 13:t.prev=13,t.t0=t.catch(1),console.log(t.t0.name),console.log(t.t0.message),a("Wrong credentials"),setTimeout((function(){a(null)}),5e3);case 19:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}();return c?Object(i.jsx)("p",{children:c}):y?Object(i.jsx)("p",{children:"User is logged"}):Object(i.jsx)(N,{username:l,password:p,handleLogin:k,handleUsernameChange:function(e){var t=e.target;return O(t.value)},handlePasswordChange:function(e){var t=e.target;return x(t.value)}})}var L=function(e){var t=e.message;return null===t?null:Object(i.jsx)("div",{className:"error",children:t})},C=function(e){var t=e.note,n=e.toggleImportance,r=t.important?"make not important":"make important";return Object(i.jsxs)("li",{className:"note",children:[Object(i.jsx)(o.b,{to:"/notes/".concat(t.id),children:t.content}),Object(i.jsx)("button",{onClick:n,children:r})]})};function U(e){var t=e.addNote,n=e.handleLogout,c=Object(r.useState)(""),a=Object(d.a)(c,2),o=a[0],s=a[1],u=Object(r.useRef)();return Object(i.jsxs)(y,{buttonLabel:"New Note",ref:u,children:[Object(i.jsx)("h3",{children:"Create a new note"}),Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({content:o,important:!1}),s(""),u.current.toggleVisibility()},children:[Object(i.jsx)("input",{type:"text",placeholder:"Write your note content",onChange:function(e){s(e.target.value)},value:o}),Object(i.jsx)("button",{type:"submit",children:"Save"})]}),Object(i.jsx)("button",{onClick:n,children:"Logout"})]})}var I=n(35);function A(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){h.a.get(f).then((function(e){return e.data})).then((function(e){c(e)}))}),[]);return{addNote:function(e){(function(e){var t={headers:{Authorization:p}};return h.a.post(f,e,t).then((function(e){return e.data}))})(e).then((function(e){return c((function(t){return[].concat(Object(I.a)(t),[e])}))})).catch((function(e){console.error(e)}))},toggleImportanceOf:function(e){var t=n.find((function(t){return t.id===e})),r=Object(x.a)(Object(x.a)({},t),{},{important:!t.important});return function(e,t){var n={headers:{Authorization:p}};return h.a.put("".concat(f,"/").concat(e),t,n).then((function(e){return e.data}))}(e,r).then((function(t){c(n.map((function(n){return n.id!==e?n:t})))}))},notes:n}}var T=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteAppUser");if(e){var t=JSON.parse(e);c(t),g(t.token)}}),[]);var a=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.next=3,v({username:n,password:r});case 3:a=e.sent,window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(a)),g(a.token),c(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{user:n,userLogout:function(){c(null),g(n.token),window.localStorage.removeItem("loggedNoteAppUser")},userLogin:a}};var E=function(){var e=A(),t=e.notes,n=e.addNote,c=e.toggleImportanceOf,a=T(),o=a.user,s=a.userLogin,u=a.userLogout,l=Object(r.useState)(!0),O=Object(d.a)(l,2),h=O[0],f=O[1],p=Object(r.useState)(null),g=Object(d.a)(p,2),v=g[0],x=g[1],m=Object(r.useState)(""),w=Object(d.a)(m,2),y=w[0],S=w[1],k=Object(r.useState)(""),I=Object(d.a)(k,2),E=I[0],J=I[1],P=function(){var e=Object(b.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{s({username:y,password:E}),S(""),J("")}catch(n){console.log(n.name),console.log(n.message),x("Wrong credentials"),setTimeout((function(){x(null)}),5e3)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=h?t:t.filter((function(e){return e.important}));return Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{children:"Notes"}),Object(i.jsx)(L,{message:v}),o?Object(i.jsx)(U,{addNote:n,handleLogout:u}):Object(i.jsx)(N,{username:y,password:E,handleLogin:P,handleUsernameChange:function(e){var t=e.target;return S(t.value)},handlePasswordChange:function(e){var t=e.target;return J(t.value)}}),Object(i.jsx)("div",{children:Object(i.jsxs)("button",{onClick:function(){return f(!h)},children:["show ",h?"important":"all"]})}),Object(i.jsx)("ul",{children:B.map((function(e,t){return Object(i.jsx)(C,{note:e,toggleImportance:function(){return t=e.id,void c(t).catch((function(e){x("Note was already removed from server"),console.error(e),setTimeout((function(){x()}),5e3)}));var t}},t)}))})]})},J=function(){return Object(i.jsx)("h1",{children:"Home Page"})},P=function(){return Object(i.jsx)("h1",{children:"Users"})},B={padding:5},D=function(){var e=T().user,t=A().notes;return Object(i.jsxs)(o.a,{children:[Object(i.jsxs)("header",{children:[Object(i.jsx)(o.b,{to:"/",style:B,children:"Home"}),Object(i.jsx)(o.b,{to:"/notes",style:B,children:"Notes"}),Object(i.jsx)(o.b,{to:"/users",style:B,children:"Users"}),e?Object(i.jsxs)("em",{children:["Logged as ",e.name]}):Object(i.jsx)(o.b,{to:"/login",style:B,children:"Login"})]}),Object(i.jsxs)(s.d,{children:[Object(i.jsx)(s.b,{path:"/notes/:id",children:Object(i.jsx)(u,{notes:t})}),Object(i.jsx)(s.b,{path:"/users",children:Object(i.jsx)(P,{})}),Object(i.jsx)(s.b,{path:"/notes",children:Object(i.jsx)(E,{})}),Object(i.jsx)(s.b,{path:"/login",render:function(){return e?Object(i.jsx)(s.a,{to:"/"}):Object(i.jsx)(k,{})}}),Object(i.jsx)(s.b,{path:"/",children:Object(i.jsx)(J,{})})]})]})};a.a.render(Object(i.jsx)(D,{}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.d31b7e97.chunk.js.map